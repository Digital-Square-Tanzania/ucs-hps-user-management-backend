import prisma from "../../config/prisma.js";
import fs from "fs";
import path from "path";

class RawFileSeeder {
  constructor() {
    this.prisma = prisma;
  }

  // Method to read and execute SQL from file
  async seedFromFile(entityName, filePath) {
    try {
      console.log(`üå± Seeding ${entityName} from SQL file...`);

      // Resolve the absolute path relative to the project root
      const sqlFilePath = path.resolve(filePath);
      const sql = fs.readFileSync(sqlFilePath, "utf8");

      // Execute raw SQL
      await this.prisma.$executeRawUnsafe(sql);

      console.log(`‚úÖ ${entityName} seeded successfully from SQL file.`);
    } catch (error) {
      console.error(`‚ùå Error during ${entityName} seeding:`, error);
      process.exit(1);
    } finally {
      await this.prisma.$disconnect();
    }
  }
}

export default RawFileSeeder;
